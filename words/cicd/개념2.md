# 추가적인 cicd 학습 을 위한 정리

- 병합을 할때 pull에 문제가 발생한다면 이에 대해서 merge를 받고 병합을 시도합니다.  

- cicd를 할때 code를 main에 병합하지 못하게 하는 ice상태를 적용해서 배포에 안전을 기한다. ( 여기에서는 작긴 하지만 명목상은 하는게 좋을것 같다. )

- 문제점을 발견하게 되었을때 즉시 수정에 착수한다. 코드 프리징 시간에는 main 브런치를 받아와서 제대로 작동하는지에 대해서 테스트하고 검증하는 단계를 가지게 된다. -> 이 과정이 바로 develop -> main 브런치를 옮기는 과정

- 이때 문제가 발생하는지 여부를 테스트 하기 위해서 main을 받고 이에 따른 테스트 과정을 거친다. 

- 병합한 main 브런치를 테스트 하고 배포를 하면 된다.

- 이러한 develop은 main 브런치에 맞는 테스트를 해야 하고 이 부분에 대해서 맞는 테스트를 해주어야 할 것 같다. 

- CI/CD는 인간의 관리에서 벋어나서 이 부분에 대해서 테스팅 할 수 있게 해준다.

- CI 테스트에서는 단위테스트를 진행하고 package를 진행 한 후 통합 테스트를 진행한다.

- artifact( 우리는 docker hub )를 통해서 CD 파이프 라인에서는 dev를 생성하고 통합, 보안, e2e 테스트를 거친 후 머무는 상태가 된다 그리고 마지막으로 배포가 진행이 되는 것이다. 

- 내가 공부해야 하는 방향 중에 하나가 바로 테스팅 부분이다 이부분을 업그레이드 해야 더 견고한 CI/CD가 가능하다.

- 자주 통합하라는 의미에 CI(지속 적인 통합이라고 부르는 것이다.)

- 병합을 자주 해줌으로써 한번에 병합하면서 오는 스트레스를 해소할 수 있는 것이다.

- 개발자들은 더 많이 여러번 commit 하기를 권장한다 한번에 커밋하고 푸시하면 충돌처리가 너무 스트레스 받기 때문에 따라서 신속한 commit은 매우큰 개발에 효율성을 주고 안정성을 준다.

## docker hub 개념

- Docker hub는 내가 홈페이지 원격으로 로그인 할때 access_token을 사용하는 것을 권장한다. 

- 비밀번호를 평문으로 노출하는 자동화 과정에서 사용하게 되었을때 보안 위험이 발생할 수 있기 때문이다.

- Docker는 빌드된 실행 환경 이미지를 관리하는 장소라고 생각하면 된다. 

- CI/CD에서 Docker Hub가 자주 쓰이는 이유는 빌드 결과물을 업로드 하다 보니 그걸 빌드하고 테스트를 자동화 하는 단계에서 그 빌드 이미지를 push 하는 부분에서 자주 쓰일 수 밖에 없는 것이다.

- CD 단계에서 배포에서는 Pull을 받아서 이미지를 가져와서 이에 대해서 

- dockerhub에서 이름을 지을때 dockerhub에 저장소 구조 규칙에 따라서 저장을 해야 한다. 일단 반드시 
```php-template
<dockerhub_username>/<rep_name>:<tag>
```  
- 이를 이용해서 해당 rep을 정할 수 있고 그 rep에 tag를 자유롭게 지정할 수 있다. 무조건 latest를 사용할 것이고 그 전에거를 사용하려면 따른 태그를 사용해야 한다.

- jenkines를 사용하게 된다면 jenkins 내에서 kubernetes를 사용해서 자동화 도구를 집적 짜가지고 개발 환경에 집어 넣는 작업도 할 수 있다.

- github action, jenkins, gitlab등 모두 파이프라인을 사용할 수 있고 이를 이용해서 CI/CD를 짤 수 있다.

- devops를 이용해서 docker hub에서 kubernetes를 이용해서 배포가 가능할 수 있고 aws를 이용해서도 배포가 가능하다. 

- e2e 테스트는 설정 파일, backend service, database 모든 부분에 대해서 테스팅을 진행한다.

- 이러한 통합 테스트 라인을 작성하고 이에 대해서 CD pipeline을 이용해서 엔드 투 엔드 테스트를 진행할 수 있다.

- 배포한 다음에 End-to-End 테스트를 진행하고 보안 문제에 대해서 스캔하는 테스트를 배포 직전에 반드시 해주어야 한다.

- devops에서 보안 문제를 잡기 위한 테스팅이 또 존재한다 이를 이용해서 보안 문제를 해결할 수 있다.

- 매번, 여러번, 매주 실행하는 자동화된 테스트를 작성하는데 시간을 투자해야 한다.

- CD는 지속적인 배포즉 Continous Delivery인 CD를 말하고 지속적인 통합인 CI는 Continuos Intergrations을 말한다.

- 이를 이용해서 CI/CD를 구축할 수 있다.

- 코드에 대한 동결여부를 정하고 이때는 staging즉 develop에 branch가 되어서는 안된다.

- 프로덕션에 배포하기 직전에 수동으로 확인하는 것이 보통이기는 하다 즉 배포 단계에서는 자동화가 있는게 아닌 아주 쉽게 버튼 한번으로 staging에서 배포로 넘어갈 수 있게 해주어야 한다.

- staging에서 하는 테스트는 퍼포먼스 테스트, compliance Check, Security test 등 우리가 배포했을때 생기는 요소에 대해서 테스트를 진행한다. -> 이때는 버튼을 이용해서 버튼을 클릭하면 배포가 되도록 시행할 수 있다.

- 우리 같은 경우는 develop -> main으로 pr을 보낼때 이 이벤트가 발생하도록 해야할 것 같다. ( push는 안되도록 막아야 함 )

- pr을 하면 바로 배포가 되도록 수정을 해야 한다. -> ( 코드 프리징 주의 )

- develop -> 배포로 갈때는 바로 되는데 이때 불안함이 생길 수 있다 배포 후에 하는 테스트가 있는데 이 종류에는 Canary deployment(조금씩 comfort 존을 높여 가면서 허용가능한 부분을 조사한다.) 

- 배포 버전과 운영중인 버전을 나누어서 조금씩 점진적으로 늘리는 방향에 대해서 연구를 해주어야 한다.

- Blue green deploy ment는 최신 버전으로 일단 배포하다가 문제가 생기면 바로 전에 버전으로 백을 하는 것을 말한다.

- 이러한 메인 아이디어를 통해서 배포에 대해서 연구를 해주어야 한다는 것이다 이러한 안전 장치는 배포를 더 자주 이루어 지게 한다. CI/CD는 자동화 하면서 팀의 큰 가치를 불러온다는 것을 알 수 있다.